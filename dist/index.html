<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8" />
	<title>Chat App | Richard Álvarez</title>
	<meta name="viewport" content="width=device-width,initial-scale=1" />
	<meta name="description" content="" />
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
	<link rel="stylesheet" type="text/css" href="css/index.css" />
	<link rel="stylesheet" type="text/css" href="css/main.css" />
	<link rel="stylesheet" type="text/css" href="css/normalize.css" />
	<link rel="icon" href="favicon.png">
	<meta name="theme-color" content="#009dff">
</head>

<body>
	<div id="fadein" class="position-fixed w-100 h-100 bg-white" style="animation: fadeinall 1s normal 0.3s both;"></div>
	<div id="users"></div>
	<form id="register-form">
		<input type="text" name="username" placeholder="Username" required />
		<input type="email" name="email" placeholder="Email" required />
		<input type="password" name="password" placeholder="Password" required />
		<button type="submit">Register</button>
	</form>

	<script src="/js/vendor/sockjs.min.js"></script>
	<script>
		const socket = io();
		const usersList = document.getElementById('users');
		const registerForm = document.getElementById('register-form');
		
		// Handle updates to the list of online users
		socket.on('online-users', (users) => {
			usersList.innerHTML = '';
			users.forEach((user) => {
				const li = document.createElement('li');
				li.textContent = user;
				usersList.appendChild(li);
			});
		});
		
		// Handle registration form submission
		registerForm.addEventListener('submit', (event) => {
			event.preventDefault();
			const formData = new FormData(registerForm);
			const data = {
				username: formData.get('username'),
				email: formData.get('email'),
				password: formData.get('password')
			};
			fetch('/chat/register', {
				method: 'POST',
				headers: {
					'Content-Type': 'application/json'
				},
				body: JSON.stringify(data)
			})
			.then((response) => response.json())
			.then((result) => {
				if (result.status === 'success') {
					console.log('Registration successful!');
				} else {
					console.error(result.message);
				}
			})
			.catch((err) => {
				console.error(err);
			});
		});
	</script>
	<!--[if IE]><div class="position-fixed bottom-0 w-100 p-2 text-bg-dark d-flex justify-content-between"><p>Outdated browser dectected. Please use a modern browser for a better browsing experience.</p><button type="button" class="btn-close btn-close-white" onClick="parentNode.remove()" aria-label="Close"></button></div><![endif]-->
	<!-- ░░░░░▄▄▄▄▀▀▀▀▀▀▀▀▄▄▄▄▄▄░░░░░░░░ -->
	<!-- ░░░░░█░░░░▒▒▒▒▒▒▒▒▒▒▒▒░░▀▀▄░░░░ -->
	<!-- ░░░░█░░░▒▒▒▒▒▒░░░░░░░░▒▒▒░░█░░░ -->
	<!-- ░░░█░░░░░░▄██▀▄▄░░░░░▄▄▄░░░░█░░ -->
	<!-- ░▄▀▒▄▄▄▒░█▀▀▀▀▄▄█░░░██▄▄█░░░░█░ -->
	<!-- █░▒█▒▄░▀▄▄▄▀░░░░░░░░█░░░▒▒▒▒▒░█ -->
	<!-- █░▒█░█▀▄▄░░░░░█▀░░░░▀▄░░▄▀▀▀▄▒█ -->
	<!-- ░█░▀▄░█▄░█▀▄▄░▀░▀▀░▄▄▀░░░░█░░█░ -->
	<!-- ░░█░░░▀▄▀█▄▄░█▀▀▀▄▄▄▄▀▀█▀██░█░░ -->
	<!-- ░░░█░░░░██░░▀█▄▄▄█▄▄█▄████░█░░░ -->
	<!-- ░░░░█░░░░▀▀▄░█░░░█░█▀██████░█░░ -->
	<!-- ░░░░░▀▄░░░░░▀▀▄▄▄█▄█▄█▄█▄▀░░█░░ -->
	<!-- ░░░░░░░▀▄▄░▒▒▒▒░░░░░░░░░░▒░░░█░ -->
	<!-- ░░░░░░░░░░▀▀▄▄░▒▒▒▒▒▒▒▒▒▒░░░░█░ -->
	<!-- ░░░░░░░░░░░░░░▀▄▄▄▄▄░░░░░░░▄█░░ -->
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
	<script type="text/javascript">
		window.onload = function(){
			setTimeout(function(){
				document.getElementById("fadein").remove();
			}, 1000);
		};
	</script>
	<script src="js/main.js"></script>
	<script src="js/plugins.js"></script>
</body>
</html>
